<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>监利市农产品质量安全追溯信息系统</title>
    <link rel="stylesheet" href="./css/reset.css" />
    <link rel="stylesheet" href="./css/index.css" />
    <!--轮播图相关-->
    <link rel="stylesheet" href="./css/swiper.min.css" />

    <style>
      html,
      body {
        position: relative;
        height: 100%;
      }

      body {
        background: #eee;
        font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
        font-size: 14px;
        color: #000;
        margin: 0;
        padding: 0;
      }

      .swiper-container {
        width: 100%;
        height: 100%;
      }

      .swiper-slide {
        background-position: center;
        background-size: cover;
      }

      /*  轮播图底部*/
      .imgSpan {
        display: block;
        width: 100%;
        height: 36px;
        color: #fff;
        font-size: 16px;
        line-height: 36px;
        text-indent: 15px;
        position: absolute;
        left: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.7);
      }
    </style>
  </head>
  <body>
    <div class="banner"></div>

    <div class="title-container">
      <img class="system-logo" src="https://cn.vuejs.org/images/logo.png" alt="img" />
      <h1 class="system-title">监利市农产品质量安全追溯信息系统</h1>
      <div class="search-section">
        <input class="search-input" type="text" placeholder="请输入搜索内容..." />
        <button class="search-btn">搜索</button>
      </div>
    </div>

    <div class="mainer">
      <div class="nav-list">
        <a class="nav-item active" href="javascript:;">首页</a>
        <a class="nav-item" href="./html/farm-news/farm-news.html">农业新闻</a>
        <a class="nav-item" href="./html/laws-regulations/laws-regulations.html">政策法规</a>
        <a class="nav-item" href="./html/work-trend/work-trend.html">工作动态</a>
        <a class="nav-item" href="./html/farm-products/farm-products.html">特色农产品</a>
        <a class="nav-item" href="./html/company-show/company-show.html">企业名录</a>
        <a class="nav-item" href="./html/supervision-admin/supervision-admin.html">监督管理</a>
        <a class="nav-item" href="./html/supervision-organ/supervision-organ.html">监督机构</a>
        <a class="nav-item" href="./html/suggest/suggest.html">投诉建议</a>
      </div>

      <!--<div class="info-section">
      <span class="info-title">通知公告：</span>
      <div class="info-swiper">
        <span class="info-swiper-text"
          >通知公告内容内容通知公告内容内容通知公告内容内容通知公告内容内容通知公告内容内容通知公告内容内容</span
        >
        <span class="info-swiper-time">2020-09-07</span>
      </div>
    </div>-->

      <div class="wether-section">
        <!--<div class="wether-swiper">
          <span>2020年9月7日</span>
          <span>星期一</span>
          <span>监利</span>
          <span>24℃~32℃</span>
          <span>空气质量：良好</span>
        </div>-->
        <!--<div class="ims-entrance">
          <img src="./images/ims-entrance.png" alt="img" />
          <span>追溯平台入口</span>
          <img class="right-arrows" src="./images/right.png" alt="img" />
          <img
            class="right-arrows-hover"
            src="./images/right_hover.png"
            alt="img"
          />
        </div>-->
      </div>

      <div class="farmInfo-section">
        <div class="farmInfo-swiper">
          <!--<img
              class="farmInfo-swiper-img"
              src="https://cn.vuejs.org/images/logo.png"
              alt="img"
            />-->
          <div class="swiper-container swiper1">
            <div class="swiper-wrapper" id="swiperWrapper">
              <!-- <div class="swiper-slide">
                       <a href="./html/farm-news/news-detail.html">
                         <img src="http://www.moa.gov.cn/xw/zwdt/202009/W020200921584947296444.jpg">
                         <span class="imgSpan">农业农村部召开促进返乡留乡农民工就地就近就...</span>
                       </a>
                     </div>-->
            </div>
            <!-- Add Pagination -->
            <div style="left: 250px" class="swiper-pagination swp1"></div>
            <!-- Add Arrows -->
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
          </div>
        </div>
        <div class="work-news">
          <div class="news-nav">
            <span class="news-title active" id="workTag">工作动态</span>
            <span class="news-title" id="lawTag">政策法规</span>
          </div>
          <div id="workDynamic" class="news-list"></div>
          <div id="lawNews" class="news-list" style="display: none"></div>
        </div>
        <div class="track-search">
          <div class="ims-entrance">
            <img src="./images/ims-entrance.png" alt="img" />
            <a href="./html/retrospect-detail/retrospect-detail.html"> <span>追溯平台入口</span></a>
            <img class="right-arrows" src="./images/right.png" alt="img" />
            <img class="right-arrows-hover" src="./images/right_hover.png" alt="img" />
          </div>

          <p>
            <input class="track-input" type="text" placeholder="请输入溯源码查询" />
            <button class="track-search-button">查询</button>
          </p>
          <div class="nums-list">
            <a>1</a>
            <a>2</a>
            <a>3</a>
            <button id="delButton">
              <img class="nums-ctrl-img" src="./images/left.png" alt="img" />
            </button>
            <a>4</a>
            <a>5</a>
            <a>6</a>
            <button id="cleanButton">
              <img class="nums-ctrl-img" src="./images/X.png" alt="img" />
            </button>
            <a>7</a>
            <a>8</a>
            <a>9</a>
            <a>0</a>
          </div>
        </div>
      </div>

      <div class="middle-illustration">
        <img src="./images/middle-illustration-1.png" alt="img" />
      </div>

      <div class="refer-section">
        <div class="farming-news">
          <div class="farming-news-top">
            <span class="farming-news-title">农业新闻</span>
            <a href="./html/farm-news/farm-news.html"><span class="farming-news-more">更多 >></span></a>
          </div>
          <div class="news-list" id="farmNews">
            <div class="news-item">
              <span class="dot-label"></span>
              <a class="news-item-text">焦点突出问题 加强指导监督</a>
              <span class="news-item-time">2020-09-07</span>
            </div>
          </div>
        </div>
        <div class="farming-news">
          <div class="farming-news-top">
            <span class="farming-news-title">监督管理</span>
            <a href="./html/farm-news/farm-news.html"><span class="farming-news-more">更多 >></span></a>
          </div>
          <div class="news-list farming-section" id="superviseNews">
            <div class="news-item">
              <span class="dot-label"></span>
              <a class="news-item-text">[监利市公共检验中心] 检测质量</a>
              <span class="news-item-time">2020-09-07</span>
            </div>
          </div>
        </div>
      </div>

      <div class="product-section">
        <div class="product-top">
          <span class="product-show">产品展示</span>
          <img src="./images/bottom.png" alt="img" />
          <a href="./html/farm-products/farm-products.html">
            <span class="product-more">更多 >></span>
          </a>
        </div>
        <div class="product-swiper">
          <div class="swiper-container swiper2">
            <div class="swiper-wrapper" id="productWrapper">
              <div class="swiper-slide">
                <a href="./html/farm-products/products-deatil.html?">
                  <img class="swiper-item-img" src="./images/product-1.png" alt="image" />
                  <p>茶叶</p>
                </a>
              </div>
            </div>
            <!-- Add Pagination -->
            <div class="swiper-pagination swp2"></div>
          </div>
        </div>
      </div>

      <div class="bottom-illustration">
        <img src="./images/middle-illustration-1.png" alt="img" />
      </div>

      <div class="product-section">
        <div class="product-top">
          <span class="product-show">企业宣传</span>
          <img src="./images/bottom.png" alt="img" />
          <a href="./html/company-show/company-show.html">
            <span class="product-more">更多 >></span>
          </a>
        </div>
        <div class="product-swiper">
          <!--          <div class="swiper-list">-->
          <div class="swiper-container swiper3">
            <div class="swiper-wrapper" id="companyWrapper">
              <div class="swiper-slide">
                <img class="swiper-item-img" src="./images/company-1.jpg" alt="image" />
                <p>中迪联创科技有限公司</p>
              </div>

              <div class="swiper-slide">
                <img class="swiper-item-img" src="./images/company-1.jpg" alt="image" />
                <p>中迪联创科技有限公司</p>
              </div>
            </div>
            <!-- Add Pagination -->
            <div class="swiper-pagination swp3"></div>
          </div>

          <!--<div class="swiper-item">
              <img class="swiper-item-img" src="./images/company-1.jpg" alt="image">
              <p>中迪联创科技有限公司</p>
            </div>
            <div class="swiper-item">
              <img class="swiper-item-img" src="./images/company-1.jpg" alt="image">
              <p>中迪联创科技有限公司</p>
            </div>
            <div class="swiper-item">
              <img class="swiper-item-img" src="./images/company-1.jpg" alt="image">
              <p>中迪联创科技有限公司</p>
            </div>-->
          <!--          </div>-->
        </div>
      </div>

      <div class="link-section">
        <div class="friendLink">
          <h4>友情链接：</h4>
          <ul class="clearfix">
            <li><a href="http://www.aqsc.agri.cn/" target="_blank">中国农产品质量安全网</a></li>
            <li><a href="http://www.agri.cn/" target="_blank">中国农业信息网</a></li>
            <li><a href="http://www.greenfood.agri.cn/" target="_blank">中国绿色食品发展中心网站</a></li>
            <li><a href="http://nyt.hubei.gov.cn/" target="_blank">湖北省农业农村厅网站</a></li>
            <li><a href="http://nlj.yangling.gov.cn/" target="_blank">监利市人民政府网站</a></li>
          </ul>
        </div>
      </div>
    </div>
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
    <script src="js/api.js" type="text/javascript"></script>
    <!--轮播图-->
    <script src="./js/swiper.min.js"></script>
    <script type="text/javascript">
      $(function () {
        $('#workTag').click(function () {
          $('#workTag').addClass('active');
          $('#lawTag').removeClass('active');
          $('#lawNews').hide();
          $('#workDynamic').show(500);
        });
        $('#lawTag').click(function () {
          $('#lawTag').addClass('active');
          $('#workTag').removeClass('active');
          $('#workDynamic').hide();
          $('#lawNews').show(500);
        });
        //溯源码查询 添加数字
        $('.nums-list a').click(function () {
          let number = $(this).html();
          $('.track-input').val($('.track-input').val() + number);
        });
        //溯源码查询 删除数字
        $('#delButton').click(function () {
          $('.track-input').val(
            $('.track-input')
              .val()
              .substring(0, $('.track-input').val().length - 1)
          );
        });
        //溯源码查询 清空
        $('#cleanButton').click(function () {
          $('.track-input').val('');
        });

        //加载轮播图
        loadWrapper();

        //文章部分
        let params = [
          'pageNum=1&pageRow=6&sysType=追溯信息系统&articleType=工作动态&status=1',
          'pageNum=1&pageRow=6&sysType=追溯信息系统&articleType=政策法规&status=1',
          'pageNum=1&pageRow=6&sysType=追溯信息系统&articleType=农业新闻&status=1',
          'pageNum=1&pageRow=6&sysType=追溯信息系统&articleType=监督管理&status=1',
        ];
        let htmlContents = ['workDynamic', 'lawNews', 'farmNews', 'superviseNews'];
        for (let i = 0; i < params.length; i++) {
          loadNews(params[i], htmlContents[i]);
        }

        //产品展示 轮播图
        loadProductWrapper();
        //企业名录 轮播图
        loadCompanyWrapper();

        //加载文章
        function loadNews(param, htmlContent) {
          doApi(
            function (res) {
              if (res.status === 200) {
                var workDynamicHtml = '';
                for (let i = 0; i < res.data.rows.length; i++) {
                  let split = res.data.rows[i].pub_time.substring(0, 11);
                  workDynamicHtml +=
                    '<div class="news-item">\n' +
                    '              <span class="dot-label"></span>\n' +
                    '              <a class="news-item-text" href=' +
                    './html/farm-news/news-detail.html?' +
                    res.data.rows[i].id +
                    '> ' +
                    res.data.rows[i].title +
                    ' </a>\n' +
                    '              <span class="news-item-time"> ' +
                    split +
                    ' </span>\n' +
                    '            </div>';
                }
                $('#' + htmlContent).html(workDynamicHtml);
              }
            },
            function (err) {
              console.log(err);
            },
            null,
            '/article/list?' + param,
            'get',
            null,
            null
          );
        }

        ininCompanySwiper();

        //溯源码查询按钮
        $('.track-search-button').click(function () {
          let val = $('.track-input').val();
          let params = { productBatchNumber: val };
          if (val.trim() !== '') {
            $.ajax({
              url: 'http://192.168.8.166:8899/ProcessBatch/traceByPBN',
              data: params,
              type: 'GET',
              // async: true,
              // contentType: contentType,
              // async: true,
              success: function(res){
                console.log(res)
                if(res.status == 200){
                  location.href = './html/retrospect-detail/retrospect-detail.html?' + val;
                  val = ''
                }
              },
              error: function (err) {
                console.log(err);
              },
            });
          } else {
            alert('溯源码不能为空！');
          }
        });

        //搜索按钮
        $('.search-btn').click(function () {
          let val = $('.search-input').val();
          location.href = './html/search/commonArticleList.html?' + val;
        });
      });

      //轮播图
      function loadWrapper() {
        let param = {
          page: 1,
          size: 5,
          targetSystem: '追溯信息系统',
        };

        doApi(
          function (res) {
            if (res.status === 200) {
              var wrapperHtml = '';
              for (let i = 0; i < res.data.rows.length; i++) {
                wrapperHtml +=
                  '<div class="swiper-slide">\n' +
                  '                <a href="./html/farm-news/news-detail.html?' +
                  res.data.rows[i].articleId +
                  '">\n' +
                  "                  <img height='360' width='600' src=\"" +
                  res.data.rows[i].path +
                  '">\n' +
                  '                  <span class="imgSpan">' +
                  res.data.rows[i].title +
                  '</span>\n' +
                  '                </a>\n' +
                  '              </div>';
              }
              $('#swiperWrapper').html(wrapperHtml);
              //初始化轮播图插件
              initSwiper();
            }
          },
          function (err) {
            console.log(err);
          },
          null,
          '/carousel/page',
          'get',
          param,
          null
        );
      }

      //获取特色农产品轮播图
      function loadProductWrapper() {
        let param = {
          page: 'page=' + 1,
          size: '&size=' + 20,
        };
        doApi(
          function (res) {
            if (res.status === 200) {
              let productWrapper = '';
              let img;
              for (let i = 0; i < res.data.rows.length; i++) {
                //处理图片
                if (res.data.rows[i].imgLists.length != 0) {
                  img = 'http://' + res.data.rows[i].imgLists[0].path;
                } else {
                  img = './images/default.jpg';
                }
                productWrapper +=
                  '<div class="swiper-slide">\n' +
                  '                <a href="./html/farm-products/products-deatil.html?' +
                  res.data.rows[i].id +
                  '">\n' +
                  '                  <img class="swiper-item-img" src="' +
                  img +
                  '" alt="image">\n' +
                  "                  <p class='productName'>" +
                  res.data.rows[i].name +
                  '</p>\n' +
                  '                </a>\n' +
                  '              </div>';
              }
              $('#productWrapper').html(productWrapper);
              //初始化轮播图插件
              ininProductSwiper();
            }
          },
          function (err) {
            console.log(err);
          },
          null,
          '/product/all?' + param.page + param.size,
          'get',
          null,
          null
        );
      }

      //获取企业轮播图
      function loadCompanyWrapper() {
        let param = {
          page: 1,
          size: 20,
        };
        doApi(
          function (res) {
            if (res.status === 200) {
              let companyWrapper = '';
              let img;
              for (let i = 0; i < res.data.rows.length; i++) {
                //处理图片
                if (res.data.rows[i].imgLists.length != 0) {
                  img = 'http://' + res.data.rows[i].imgLists[0].path;
                } else {
                  img = './images/default.jpg';
                }
                companyWrapper +=
                  '<div class="swiper-slide">\n' +
                  '                <a href="./html/company-show/company-show-detail.html?' +
                  res.data.rows[i].id +
                  '">\n' +
                  '                  <img class="swiper-item-img" src="' +
                  img +
                  '" alt="image">\n' +
                  "                  <p class='productName'>" +
                  res.data.rows[i].companyName +
                  '</p>\n' +
                  '                </a>\n' +
                  '              </div>';
              }
              $('#companyWrapper').html(companyWrapper);
              //初始化轮播图插件
              ininCompanySwiper();
            }
          },
          function (err) {
            console.log(err);
          },
          null,
          '/company/allByPage',
          'get',
          param,
          null
        );
      }

      function initSwiper() {
        let swiper = new Swiper('.swiper1', {
          pagination: {
            el: '.swp1',
          },
          paginationClickable: true,
          nextButton: '.swiper-button-next',
          prevButton: '.swiper-button-prev',
          spaceBetween: 30,
          autoplay: 2500,
          effect: 'fade',
          loop: true,
        });
      }

      //初始化特色农产品轮播图
      function ininProductSwiper() {
        let swiper = new Swiper('.swiper2', {
          pagination: {
            el: '.swp2',
          },
          slidesPerView: 6,
          centeredSlides: false,
          paginationClickable: true,
          spaceBetween: 10,
          grabCursor: true,
          autoplay: 2000,
          //环路
          loop: true,
        });
      }

      //初始化企业轮播图
      function ininCompanySwiper() {
        let swiper = new Swiper('.swiper3', {
          pagination: {
            el: '.swp3',
          },
          slidesPerView: 6,
          centeredSlides: false,
          paginationClickable: true,
          spaceBetween: 10,
          grabCursor: true,
          autoplay: 5000,
          //环路
          loop: true,
        });
      }
    </script>
  </body>
  <footer class="footer">
    <a>主办单位：监利市农业农村局 &nbsp;&nbsp;</a>
    <a>承办单位：武汉中迪联创科技有限公司&nbsp;&nbsp;</a>
    <a>鄂ICP备 xxx号-1鄂公网安备 xxx号</a>
  </footer>
</html>
